# 更新日志

## [2.1.0] - 2026-01-16

### ✨ 新增功能

#### 数据迁移（超级管理员专属）

- **一键导出**
  - 导出所有用户账户和配置
  - 导出所有仓库配置和权限
  - 导出所有仓库代码和提交历史
  - 生成包含元数据的 ZIP 文件
  - 实时进度显示
  - 自动下载

- **一键导入**
  - 支持拖拽上传备份文件
  - 文件完整性验证
  - 自动备份当前数据（保留24小时）
  - 详细的导入进度（10个阶段）
  - 失败自动回滚
  - 导入完成后自动跳转登录页

- **数据统计**
  - 显示当前用户数
  - 显示当前仓库数
  - 显示数据总大小
  - 显示预计压缩后大小

- **安全机制**
  - 仅超级管理员可访问
  - 导入前确认对话框
  - 自动备份和回滚
  - 临时文件自动清理

### 📚 文档更新

- 新增《数据迁移完整使用指南》
- 新增《数据迁移快速开始指南》
- 新增《数据迁移测试清单》
- 新增《数据迁移功能总结》
- 更新系统使用帮助（添加数据迁移章节）
- 更新 README.md（添加功能说明和使用指南）

### 🔧 技术改进

- 后端新增依赖：archiver、multer、unzipper
- 新增数据迁移路由和 API
- 新增进度跟踪机制
- 优化文件上传处理
- 优化大文件压缩和解压

### 🎨 UI 优化

- 新增数据迁移页面
- 美观的统计卡片设计
- 实时进度条显示
- 友好的警告和提示信息
- 响应式布局

---

## [2.0.0] - 2026-01-15

### ✨ 新增功能

#### 文件浏览
- 树形文件浏览器，支持懒加载
- 代码语法高亮（支持 20+ 种编程语言）
- 图片预览（支持 6 种图片格式）
- 文件搜索功能
- 一键复制代码
- 一键下载文件
- 分支切换

#### 提交历史
- 可视化分支图
- 完整提交信息展示
- 提交哈希值显示
- 作者和时间信息
- 分支/标签标记
- 分页加载（20条/页）

#### 代码查看权限管理
- 细粒度的代码查看权限控制
- 默认规则：超管和管理员有权限
- 继承访问权限选项
- 自定义用户权限列表

### 🎨 UI 优化
- 优化用户界面
- 改进文件树加载性能
- 优化代码高亮显示

### 🐛 Bug 修复
- 修复文件树加载问题
- 修复权限检查逻辑
- 修复空值检查问题

---

## [1.0.0] - 2026-01-14

### ✨ 初始版本

#### 基础功能
- 用户认证和授权
- 仓库管理（创建、删除、查看）
- Git HTTP 服务（clone、push、pull）
- 用户管理（创建、删除、修改角色）
- 权限管理（基于角色的访问控制）
- 操作日志记录

#### 技术栈
- 后端：Node.js + Express
- 前端：Vue 3 + Element Plus
- Git 操作：原生 Git 命令
- 认证：JWT + HTTP Basic Auth

---

## 版本说明

### 版本号规则

采用语义化版本号：`主版本号.次版本号.修订号`

- **主版本号**：重大功能更新或不兼容的 API 修改
- **次版本号**：新增功能，向下兼容
- **修订号**：Bug 修复和小改进

### 升级建议

#### 从 2.0.0 升级到 2.1.0

1. **备份数据**（重要！）
   ```bash
   # 在旧版本中导出数据
   登录系统 → 数据迁移 → 导出所有数据
   ```

2. **更新代码**
   ```bash
   git pull origin main
   ```

3. **安装依赖**
   ```bash
   cd backend
   npm install
   
   cd ../frontend
   npm install
   ```

4. **启动服务**
   ```bash
   # 后端
   cd backend
   npm start
   
   # 前端
   cd frontend
   npm run dev
   ```

5. **导入数据**
   ```bash
   登录系统 → 数据迁移 → 导入数据
   ```

#### 从 1.0.0 升级到 2.1.0

建议先升级到 2.0.0，再升级到 2.1.0。

或者直接升级到 2.1.0，但需要注意：
- 数据库结构可能有变化
- 配置文件格式可能有变化
- 建议在测试环境先验证

---

## 即将推出

### v2.2.0（计划中）

- [ ] 选择性数据导出
- [ ] 增量数据导入
- [ ] 定时自动备份
- [ ] 云端备份支持
- [ ] 代码审查功能
- [ ] Webhook 支持
- [ ] API 文档生成

### v3.0.0（规划中）

- [ ] 多语言支持
- [ ] 主题切换
- [ ] 移动端适配
- [ ] CI/CD 集成
- [ ] 容器化部署
- [ ] 集群支持

---

## 反馈和建议

如有问题或建议，请：

1. 提交 Issue
2. 发送邮件
3. 查看文档

---

**开发者**：tinyflake  
**项目地址**：https://github.com/your-repo/git-server  
**文档地址**：https://docs.your-domain.com
