# 数据迁移快速开始

## 🎯 5 分钟快速上手

### 场景：版本升级时保留数据

假设你要从 v2.0 升级到 v2.1，需要保留所有用户和仓库数据。

---

## 步骤 1：在旧版本导出数据

### 1.1 登录旧版本系统

```
访问：http://localhost:3000
用户名：admin
密码：你的密码
```

### 1.2 导出数据

1. 点击右上角用户菜单
2. 选择"数据迁移"
3. 点击"导出所有数据"按钮
4. 等待下载完成

**结果**：得到一个文件 `data-backup-2026-01-16T10-30-00.zip`

---

## 步骤 2：安装新版本

### 2.1 下载新版本

```bash
# 下载 v2.1 版本
git clone https://github.com/your-repo/git-server.git git-server-v2.1
cd git-server-v2.1
```

### 2.2 安装依赖

```bash
# 后端
cd backend
npm install

# 前端
cd ../frontend
npm install
```

### 2.3 启动新版本

```bash
# 启动后端
cd backend
npm start

# 启动前端（新窗口）
cd frontend
npm run dev
```

---

## 步骤 3：在新版本导入数据

### 3.1 登录新版本系统

```
访问：http://localhost:3000
用户名：admin
密码：123456（新版本默认密码）
```

### 3.2 导入数据

1. 点击右上角用户菜单
2. 选择"数据迁移"
3. 拖拽或点击上传之前导出的 ZIP 文件
4. 点击"开始导入"按钮
5. 确认导入操作
6. 等待导入完成（会显示进度）
7. 自动跳转到登录页

### 3.3 使用旧密码登录

```
用户名：admin
密码：你的旧密码（不是 123456）
```

---

## ✅ 完成！

现在你的新版本系统已经包含了所有旧版本的数据：
- ✅ 所有用户账户
- ✅ 所有仓库
- ✅ 所有代码
- ✅ 所有权限配置

---

## 🔍 验证数据

### 检查用户

1. 进入"用户管理"
2. 确认所有用户都在

### 检查仓库

1. 进入首页
2. 确认所有仓库都在

### 检查代码

1. 进入任意仓库
2. 点击"文件"选项卡
3. 确认代码完整

---

## ⚠️ 注意事项

### 1. Admin 密码变化

导入后，admin 密码会变成旧版本的密码，不再是 123456。

### 2. 数据覆盖

导入会覆盖新版本的所有数据，包括默认的 admin 账户。

### 3. 备份建议

- 导出的文件请妥善保管
- 建议保留多个版本的备份
- 定期导出数据

---

## 🚨 常见问题

### Q1: 导入后无法登录？

**A**: 使用旧版本的密码，不是新版本的默认密码。

### Q2: 导入失败怎么办？

**A**: 系统会自动回滚，不会丢失数据。检查：
- 文件是否完整
- 磁盘空间是否足够
- 查看后端日志

### Q3: 可以跨多个版本升级吗？

**A**: 可以，但建议逐个版本升级，确保兼容性。

### Q4: 导入需要多长时间？

**A**: 取决于数据大小：
- 小型项目（<100MB）：几秒
- 中型项目（100MB-1GB）：几十秒
- 大型项目（>1GB）：几分钟

---

## 📞 需要帮助？

如果遇到问题，请：

1. 查看 [完整文档](./docs/DATA-MIGRATION-GUIDE.md)
2. 查看后端日志
3. 提交 Issue

---

**祝你升级顺利！** 🎉
